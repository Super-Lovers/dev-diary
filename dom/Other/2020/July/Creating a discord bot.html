<!DOCTYPE html><html lang="en"><head>
    <title>Nikolay&apos;s Games and Dev. Diary</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#5373F4">

    <!-- Primary Meta Tags -->
    <meta name="author" content="Nikolay Vaskov Ivanov">
    <meta name="title" content="Nikolay&apos;s Games and Dev. Diary">
    <meta name="description" content="A Developer diary and games that I helped develop throughout my career. I write about game development, tooling, and other software that I worked with.">

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="Nikolay&apos;s Games and Dev. Diary">
    <meta property="og:site_name" content="Nikolay&apos;s Games and Dev. Diary">
    <meta property="og:url" content="https://nikolayivanov.onrender.com/">
    <meta property="og:description" content="A Developer diary and games that I helped develop throughout my career. I write about game development, tooling, and other software that I worked with.">
    <meta property="og:type" content="website">
    <meta property="og:image:width" content="300">
    <meta property="og:image:height" content="300">
    <meta property="og:image" content="images/niko_anim.png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@Nikolay64625418">
    <meta name="twitter:title" content="Nikolay&apos;s Games and Dev. Diary">
    <meta name="twitter:description" content="A Developer diary and games that I helped develop throughout my career. I write about game development, tooling, and other software that I worked with.">
    <meta property="twitter:image" content="images/niko_anim.png">

    <!-- Favicons -->
    <link class="link" rel="apple-touch-icon" sizes="180x180" href="../../../../favicons/apple-touch-icon.png">
    <link class="link" rel="icon" type="image/png" sizes="32x32" href="../../../../favicons/favicon-32x32.png">
    <link class="link" rel="icon" type="image/png" sizes="16x16" href="../../../../favicons/favicon-16x16.png">
    <link class="link" rel="manifest" href="../../../../favicons/site.webmanifest">
    <link class="link" rel="shortcut icon" href="../../../../favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="favicons/browserconfig.xml">

    <!-- Main References -->
    <link rel="stylesheet" class="link" href="../../../../styles/lib/atelier-seaside-dark.min.css">
    <link rel="stylesheet" class="link" href="../../../../styles/styles.min.css">
    <link rel="stylesheet" class="link" href="../../../../node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" class="link" href="../../../../node_modules/@fortawesome/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" class="link" href="../../../../styles/lib/imagehover.min.css">
    <link rel="stylesheet" class="link" href="../../../../node_modules/plyr/dist/plyr.css">
    <!-- <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="Sat, 12 Oct 1991 05:00:00 GMT" /> -->
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-xl-4 col-lg-12 aside custom-col">
                <div class="header text-center card-group">
                    <figure class="imghvr-fade-in-up rounded-lg" style="background-color:#ffffff;">
                        <video class="link portrait-video" src="../../../../images/niko_anim.mp4" autoplay loop></video>
                        <figcaption style="background-color: #2f4f4f;">
                            <h2>Nikolay Vaskov Ivanov</h2>
                            <p class="portrait-description">Born in 3rd of march, 1998 in the Bulgarian city Pazardzhik, I studied in the school
                                &quot;Prof. Ivan Batakliev&quot; until 8th grade and completed the specialty &quot;System Programming&quot;
                                when I graduated 12th grade. Currently studying for a Bachelor&apos;s degree in the
                                Netherlands.</p>
                        </figcaption>
                    </figure>
					<div class="alert alert-success status-bar border-success rounded-bottom">
						&gt; Learning about <b>game hacking</b> <span>&#x1F3B2;</span>
					</div>
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-1"><a rel="noopener" aria-label="My github" target="_blank" href="https://github.com/Super-Lovers">
                                    <i class="fab fa-github-alt"></i></a></div>
                            <div class="col-1"><a rel="noopener" aria-label="My linkedin" target="_blank" href="https://www.linkedin.com/in/nikolay-ivanov-301346182/">
                                    <i class="fab fa-linkedin-in"></i></a></div>
                            <div class="col-1"><a rel="noopener" aria-label="itch.io profile" target="_blank" href="https://back-body-hurts.itch.io/">
                                    <i class="fab fa-itch-io"></i></a>
                            </div>
                            <div class="col-1"><a aria-label="My email" href="mailto:n.v.ivanov@st.hanze.nl">
                                    <i class="fas fa-envelope"></i></a>
                            </div>
                            <div class="col-1"><a class="link" aria-label="humans.txt file" rel="noopener" target="_blank" href="../../../..//humans.txt">
                                <i class="fas fa-hammer"></i></a>
                            </div>
                            <div class="col-7"></div>
                        </div>
                        <p>Student in Game Design and Development
                            at Hanze University of Applied Sciences in Groningen, previously Game Programmer intern at &amp;ranj.</p>
                        <audio id="audio-player" loop>
                            <source class="link" src="../../../../audio/Ana_kiss.mp3" type="audio/mp3">
                        </audio>
                    </div>

                </div>

                <hr class="style14">

                <div class="fortune rounded-sm row">
                    <div class="col-md-2 col-sm-12">
                        <img class="link align-middle" src="../../../../images/fortune_cookie.png" alt="fortune cookie">
                    </div>
                    <div class="col-md-10 col-sm-12">
                        <p class=" align-middle fortune-text"></p>
                        <i class="fas fa-quote-right"></i>
                    </div>
                </div>

                <hr class="style14">

                <div class="posts-container">
                    <div>
                        <a class="link" href="../../../../index.html">
                            <h6><b><em><i class="fas fa-home"></i> Home <i class="fas fa-caret-left"></i></em></b></h6>
                        </a>
                        <a class="link" href="../../../../portfolio.html">
                            <h6><b><em><i class="fas fa-chess-queen"></i> Games <i></i></em></b></h6>
                        </a>
                        <a target="_blank" class="link" href="../../../../images/resume.pdf">
                            <h6><b><em><i class="fas fa-user"></i> Resume <i></i></em></b></h6>
                        </a>
                        <a rel="noopener" target="_blank" href="http://users4.smartgb.com/g/g.php?a=s&amp;i=g44-80382-01">
                            <h6><b><em><i class="fas fa-pen-alt"></i> Sign my Guestbook <i></i></em></b></h6>
                        </a>
                        <a id="themeToggle" href="#!">
                            <h6><b><em><i class="fas fa-moon"></i> Switch to dark theme <i></i></em></b></h6>
                        </a>
                    </div>
                    <div>
                        <h6>Posts Archive</h6>
                        <ul class="archive"><li>Lifestyle<ul><li class="year"><span class="yearLabel"><i class="fas fa-caret-right"></i> 2020</span>    <ul>    <li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Lifestyle/2020/April/My work-life balance.html"><b>My work-life balance</b></a>    </li></ul></li></ul></li><li>Lua<ul><li class="year"><span class="yearLabel"><i class="fas fa-caret-right"></i> 2020</span>    <ul>    <li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Lua/2020/June/Lua and Love2d.html"><b>Lua and Love2d</b></a>    </li></ul></li></ul></li><li>Other<ul><li class="year"><span class="yearLabel"><i class="fas fa-caret-right"></i> 2020</span>    <ul>    <li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Other/2020/July/Creating a discord bot.html"><b>Creating a discord bot</b></a>    </li><li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Other/2020/October/Wallpaper creator &amp; Candles update.html"><b>Wallpaper creator &amp; Candles update</b></a>    </li><li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Other/2020/September/Rainy Day and slbms.js update.html"><b>Rainy Day and slbms.js update</b></a>    </li></ul></li></ul></li><li>Twine<ul><li class="year"><span class="yearLabel"><i class="fas fa-caret-right"></i> 2020</span>    <ul>    <li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Twine/2020/August/Working with Twine, Sugarcube 2.html"><b>Working with Twine, Sugarcube 2</b></a>    </li></ul></li></ul></li><li>Unity3D<ul><li class="year"><span class="yearLabel"><i class="fas fa-caret-right"></i> 2019</span>    <ul>    <li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Unity3D/2019/November/Narrative-development tooling.html"><b>Narrative-development tooling</b></a>    </li></ul></li></ul></li><li>Web<ul><li class="year"><span class="yearLabel"><i class="fas fa-caret-right"></i> 2020</span>    <ul>    <li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Web/2020/February/Bookmarks viewer CLI.html"><b>Bookmarks viewer CLI</b></a>    </li><li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Web/2020/January/Light posts generator.html"><b>Light posts generator</b></a>    </li><li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Web/2020/July/Learning Electronjs.html"><b>Learning Electronjs</b></a>    </li><li><i class="fas fa-align-left"></i> <a class="archive-link" href="../../../../dom/Web/2020/July/Wallpaper creation tool.html"><b>Wallpaper creation tool</b></a>    </li></ul></li></ul></li></ul>
                    </div>
                </div>
            </div>
            <div class="col-12 custom-col" style="max-width:740px">
                <header class="container-fluid">
                    <div class="row">
                        <div class="col-md-12 col-sm-12">
                            <h1>Nikolay&apos;s Games and Dev. Diary</h1>
                            <p><i class="fas fa-sync-alt"></i><em class="update-status">Last updated on 9/12/2020 Europe/Berlin</em></p>
                        </div>
                    </div>
                    <p>Here, you can find out about my personal and professional experiences throughout my education and
                        personal development. This website consists of <u>developer diary posts</u> and <u>games</u>
                        that I helped develop throughout my career. I write and intend to write about game development
                        and tools that I experienced and other software development fields as well. You can learn more
                        about less notable work I did, not present on my website, on my <a href="https://github.com/Super-Lovers">Github <i class="fab fa-github-alt"></i></a> instead. Finally, you may find my <a target="_blank" class="link" href="../../../../images/resume.pdf">Resume</a> on the left sidebar&apos;s links if you&apos;re interested!</p>
                </header>

                <hr class="style14">

                <main class="container-fluid posts">

                <div><h3>Creating a discord bot</h3>
<h5>Uploaded on 9th July, 2020. <em style="font-size:15px;color:lightslategray;"><i class="fas fa-hourglass-half"></i> Read time: 7m</em></h5>
<p><span class="drop">M</span>y friend Kris and I wanted to make a <i class="fab fa-discord"></i> discord bot to log our cycling activity and share it with other people. I&apos;ve had some experience with making a discord bot in the past when discord was riding in popularity. There is a dot NET wrapper to developing it, but I decided to go with the JavaScript alternative, being Discord.js since the documentation was more detailed.</p>
<p>The first thing I did was hooking the bot to a MongoDB instance in a cluster I had for free in order to store the logs of cycling activity there. I also used a second collection for storing each user&apos;s activity so that I can easily work with the bot when multiple people are communicating with it, otherwise I risk mixing their data or the bot&apos;s state up. I use MongoDB Compass to interact with the instance while developing with it, since a console or a webpage is not as convenient:</p>
<p style="text-align: center;"><img class="img-fluid" src="../../../../diary-imgcompressed/Web/2020/July/images/mongoCompass.png" alt="A picture of mongoDB compass&apos;s interface"></p>
<p>Before I start connecting with the instance, I make sure that I don&apos;t already have a connection going and after that the main function of the bot is initiated:</p>
<pre class="shadow-sm code-block"><code class="javascript language-javascript">if (db === undefined) {
    await clientMongo.connect(async () =&gt; {
        db = clientMongo.db(&apos;cycling-bot&apos;);
        main(message, command);
    });
} else {
    main(message, command);
}
</code></pre>
<p>Now that we are connected, we can start work. From my understanding, a simple bot only needs to work with one or two callbacks. Discord.js did so with the &quot;message&quot; callback and all my bot&apos;s implementation resides in it, aside from connecting to APIs. I access the callback&apos;s output, which is the user&apos;s message and its metadata and work with just that. After that, I have to breakdown the message of the user into separate parts to find out what command he gave the bot, if any, and the arguments it might have:</p>
<pre class="shadow-sm code-block"><code class="javascript language-javascript">clientDiscord.on(&apos;message&apos;, async (message) =&gt; {
    if (message.author.bot == true) {   // message.author and message.content
        return;                         // are the most important properties
    }

    // Extracts the command part of the message
    // *****************
    let command = &apos;&apos;;
    for (let i = 0; i &lt; message.content.length; i++) {
        if (i == message.content.length ||
            message.content[i] == &apos; &apos;) {
            break;
        }

        command += message.content[i];
    }
});
</code></pre>
<p>There is also the instance where you have to breakdown strings in the command message as they can be used as arguments for accessing specific sessions by title or name. That makes them harder to extract than just numbers one after the other:</p>
<pre class="shadow-sm code-block"><code class="javascript language-javascript">/**
 * Returns an object of items from inside a complex
 * command that includes strings and numbers.
 */
function getCommandBreakdown(message) {
    let indexOfFirstQuote = 0;
    let indexOfLastQuote = 0;

    let isFirstQuoteFound = false;

    const messageText = message.content;
    for (let i = 0; i &lt; messageText.length; i++) {
        if (messageText[i] == &apos;&quot;&apos; &amp;&amp; isFirstQuoteFound == false) {
            indexOfFirstQuote = i;
            isFirstQuoteFound = true;
        }

        if (messageText[i] == &apos;&quot;&apos; &amp;&amp; isFirstQuoteFound == true) {
            indexOfLastQuote = i;
        }
    }

    const commandArguments = (messageText.substring(0, indexOfFirstQuote - 1) + messageText.substring(indexOfLastQuote + 1, messageText.length)).split(&apos; &apos;);

    const sessionTitle = messageText.substring(indexOfFirstQuote, indexOfLastQuote + 1);

    return {
        commandArguments,
        sessionTitle,
        indexOfFirstQuote,
        indexOfLastQuote
    };
}
</code></pre>
<p style="text-align: center;"><img class="img-fluid" src="../../../../diary-imgcompressed/Web/2020/July/images/getSession.png" alt="A picture of mongoDB compass&apos;s interface"></p>
<p>This code, however, only work with one string in a command, as more than that was not necessary for me to implement to complete the bot&apos;s purpose. Once I had the command and its arguments, It was just a matter of implementing each of the commands&apos; functionality. Here is an example of how I made session deletion:</p>
<pre class="shadow-sm code-block"><code class="javascript language-javascript">if (command == &apos;$deleteSession&apos;) {
    const commandBreakdown = getCommandBreakdown(message);
    const result = await sessions.deleteOne({
        &apos;title&apos;: {
            $eq: commandBreakdown.sessionTitle
        }
    });

    if (result.deletedCount &gt; 0) {
        message.reply(&apos; **&apos; + commandBreakdown.sessionTitle + &apos;**&apos; + &apos; was successfully removed &#x2705;&apos;);
    }
}
</code></pre>
<p style="text-align: center;"><img class="img-fluid" src="../../../../diary-imgcompressed/Web/2020/July/images/deleteSession.png" alt="A picture of mongoDB compass&apos;s interface"></p>
<p>And of course, it is important that you give feedback to the user whether or not his command was carried out!</p></div></main>
                <hr class="style14">
                <footer>
                    <div>
                        <p style="text-align: center;">
                            <a rel="noopener" target="_blank" title="Link to the loving and talented artist who made my portrait art!" href="https://www.artstation.com/wogew">
                                <img class="link footer-icon" src="../../../../images/cat.gif" alt="Link to the loving and talented artist who made my portrait art!">
                            </a>
                    </p></div>
                    <div>
                        <p style="text-align: center;">
                            <a rel="noopener" target="_blank" href="https://validator.w3.org/check?uri=referer"><img class="footer-icon" src="https://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="27" width="78"></a>
                        </p>
                    </div>
                    <div>
                        <p style="text-align: center;">
                            <a rel="noopener" target="_blank" href="https://jigsaw.w3.org/css-validator/check/referer">
                                <img class="footer-icon" style="border:0;width:78px;height:27px" src="https://jigsaw.w3.org/css-validator/images/vcss" alt="Valid CSS!">
                            </a>
                        </p>
                    </div>
                    <div>Made by Nikolay</div>
                </footer>
            </div>
        </div>
    </div>
    <!-- <audio id="audioPlayer" class="link" loop src="audio/Clem%20leek%20-%20Rest%20-%2005%20Into%20The%20Wind.mp3"></audio> -->
    <script class="link" src="../../../../node_modules/jquery/dist/jquery.min.js"></script>
    <script class="link" src="../../../../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script class="link" src="../../../../scripts/lib/highlight.pack.js"></script>
    <!-- <script class="link" src="scripts/audio.min.js"></script> -->
    <script class="link" src="../../../../scripts/fortune-cookie.min.js"></script>
    <script class="link" src="../../../../node_modules/plyr/dist/plyr.min.js"></script>
    <script class="link" src="../../../../scripts/main.min.js"></script>
    <script class="link" src="../../../../scripts/theme.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>


</body></html>